# Техническое задание на проект: Трекер настроения на основе анализа текстовых записей в дневнике с выявлением триггеров

## 1. Цель проекта
Разработка веб-сервиса для отслеживания настроения через текстовые дневниковые записи с автоматическим анализом тональности текста и выявлением потенциальных триггеров (факторов), влияющих на эмоциональное состояние пользователя. Сервис помогает пользователям осознавать закономерности в своём настроении через визуализацию и статистику.

## 2. Роли пользователей
- **Гость**: Может просматривать демонстрационную (анонимизированную) статистику и информацию о проекте. Не имеет доступа к личным записям.
- **Аутентифицированный пользователь**: Может создавать, читать, обновлять и удалять свои дневниковые записи. Имеет доступ к персональной аналитике: графикам настроения, статистике и выявленным триггерам.
- **Администратор**: Полный доступ через Django Admin к управлению всеми моделями, пользователями и данными.

## 3. Модели данных (минимум 3 кастомные модели)
1.  **DiaryEntry** (Дневниковая запись)
    - `user` (ForeignKey к User) - автор записи
    - `text` (TextField) - текст дневниковой записи
    - `date_created` (DateTimeField, auto_now_add=True) - дата и время создания
    - `mood_score` (FloatField, null=True, blank=True) - числовая оценка настроения от -1 (очень негативное) до 1 (очень позитивное), рассчитанная системой
    - `user_mood_tag` (CharField, choices) - субъективная метка настроения от пользователя (Отличное, Хорошее, Нейтральное, Плохое, Ужасное)

2.  **ExtractedKeyword** (Извлечённое ключевое слово/тема)
    - `word` (CharField) - ключевое слово или фраза (например, "работа", "дедлайн", "прогулка")
    - `category` (CharField, choices) - категория темы (например, "Работа", "Отдых", "Семья", "Здоровье")

3.  **MoodCorrelation** (Корреляция настроения и темы)
    - `user` (ForeignKey к User) - пользователь
    - `keyword` (ForeignKey к ExtractedKeyword) - ключевое слово
    - `correlation_score` (FloatField) - коэффициент корреляции между появлением слова в записи и оценкой настроения (от -1 до 1). Отрицательное значение означает, что при упоминании темы настроение ухудшается.
    - `occurrence_count` (IntegerField) - сколько раз данная тема встречалась в записях пользователя

*Связи:* `DiaryEntry` связана с `User`. `MoodCorrelation` связана с `User` и `ExtractedKeyword`. Система будет автоматически создавать/обновлять объекты `ExtractedKeyword` и `MoodCorrelation` на основе анализа записей.

## 4. Ключевой функционал (User Stories)
*   **US1: Ведение дневника.** Авторизованный пользователь заходит в личный кабинет, нажимает "Новая запись", заполняет текстовую форму, выбирает субъективную оценку настроения и сохраняет. Система автоматически анализирует текст, определяет тональность (mood_score) и извлекает ключевые слова.
*   **US2: Просмотр истории и аналитики.** На главной странице личного кабинета пользователь видит список своих последних записей, график изменения настроения за выбранный период (линейный график Plotly) и блок "Ваши топ-триггеры" (темы с самой сильной корреляцией — как позитивной, так и негативной).
*   **US3: Детальный анализ триггеров.** Пользователь переходит на отдельную страницу "Аналитика", где видит две таблицы/диаграммы: "Что вас радует" (темы с наибольшим положительным correlation_score) и "Что огорчает" (темы с наибольшим отрицательным correlation_score). Для каждой темы показана сила влияния и частота упоминаний.
*   **US4: Обновление и удаление записей.** Пользователь может отредактировать текст любой своей прошлой записи или удалить её. При редактировании текста система заново проводит анализ и пересчитывает корреляции.
*   **US5: Администрирование.** Администратор через Django Admin видит список всех пользователей, все записи (с возможностью поиска по тексту), управляет предустановленным списком категорий для ключевых слов и может сбросить некорректные расчёты.

## 5. Внешние интеграции и аналитика
*   **Библиотеки анализа данных (Data Science)**:
    -   **TextBlob/NLTK**: Для определения тональности текста (поляризации и субъективности) и извлечения ключевых слов/тем.
    -   **Pandas**: Для агрегации данных пользователя (среднее настроение за период, подсчёт частоты тем) и расчёта корреляций между наличием тем и оценкой настроения.
    -   **Plotly**: Для построения интерактивных графиков (линейный график настроения по датам, столбчатая диаграмма силы триггеров).
*   **Интеграция с API**: *Опционально, на усложнение*. Можно добавить интеграцию с **OpenWeatherMap API**, чтобы автоматически добавлять к записи данные о погоде на дату создания и в дальнейшем анализировать, влияет ли погода на настроение пользователя.

## 6. Технический стек
*   **Backend**: Django, Django ORM
*   **Frontend**: Bootstrap 5 (для адаптивного интерфейса), шаблонизатор Django, Plotly для графиков.
*   **База данных**: SQLite (для разработки), будет мигрирована на PostgreSQL при деплое.
*   **Аналитика**: TextBlob, Pandas, Plotly
*   **Хостинг**: PythonAnywhere
*   **Система контроля версий**: Git

---
*Примечание: Это план-максимум. В ходе реализации приоритет будет отдан базовому функционалу (US1, US2, US3), а дополнительные фичи (погодный API) будут реализованы по остаточному принципу.*