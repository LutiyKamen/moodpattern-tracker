{% extends 'diary/base.html' %}

{% block title %}–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="card mb-4">
            <div class="card-header">
                <h4 class="mb-0">üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤–∞—à–µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è</h4>
            </div>
            <div class="card-body">
                <p class="text-muted">–ê–Ω–∞–ª–∏–∑ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ {{ positive_correlations.count|add:negative_correlations.count }} –≤—ã—è–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è—Ö</p>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <!-- –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã -->
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header bg-success bg-opacity-10">
                <h5 class="mb-0">üëç –ß—Ç–æ –≤–∞—Å —Ä–∞–¥—É–µ—Ç</h5>
            </div>
            <div class="card-body">
                {% if positive_correlations %}
                    <div class="list-group">
                        {% for correlation in positive_correlations %}
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>{{ correlation.keyword.word }}</strong>
                                <small class="text-muted d-block">{{ correlation.keyword.get_category_display }}</small>
                                <small>–£–ø–æ–º–∏–Ω–∞–Ω–∏–π: {{ correlation.occurrence_count }}</small>
                            </div>
                            <div class="text-end">
                                <span class="badge bg-success rounded-pill fs-6">
                                    +{{ correlation.correlation_score|floatformat:2 }}
                                </span>
                                <div class="mt-1">
                                    <small class="text-muted">{{ correlation.get_correlation_label }}</small>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="text-center py-4">
                        <div class="display-6 mb-3">üìä</div>
                        <p class="text-muted">–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤</p>
                        <small>–°–æ–∑–¥–∞–π—Ç–µ –±–æ–ª—å—à–µ –∑–∞–ø–∏—Å–µ–π –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π</small>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã -->
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header bg-danger bg-opacity-10">
                <h5 class="mb-0">üëé –ß—Ç–æ –≤–∞—Å –æ–≥–æ—Ä—á–∞–µ—Ç</h5>
            </div>
            <div class="card-body">
                {% if negative_correlations %}
                    <div class="list-group">
                        {% for correlation in negative_correlations %}
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>{{ correlation.keyword.word }}</strong>
                                <small class="text-muted d-block">{{ correlation.keyword.get_category_display }}</small>
                                <small>–£–ø–æ–º–∏–Ω–∞–Ω–∏–π: {{ correlation.occurrence_count }}</small>
                            </div>
                            <div class="text-end">
                                <span class="badge bg-danger rounded-pill fs-6">
                                    {{ correlation.correlation_score|floatformat:2 }}
                                </span>
                                <div class="mt-1">
                                    <small class="text-muted">{{ correlation.get_correlation_label }}</small>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="text-center py-4">
                        <div class="display-6 mb-3">üìâ</div>
                        <p class="text-muted">–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤</p>
                        <small>–°–æ–∑–¥–∞–π—Ç–µ –±–æ–ª—å—à–µ –∑–∞–ø–∏—Å–µ–π –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π</small>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- –ì—Ä–∞—Ñ–∏–∫ –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏ -->
{% if day_chart_html %}
<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">üìÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏</h5>
            </div>
            <div class="card-body">
                <div id="day-chart">
                    {{ day_chart_html|safe }}
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- –°–æ–≤–µ—Ç—ã -->
<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card border-success mb-3">
                            <div class="card-body">
                                <h6>–£–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã:</h6>
                                <ul class="mb-0">
                                    <li>–ß–∞—â–µ –ø–ª–∞–Ω–∏—Ä—É–π—Ç–µ –∑–∞–Ω—è—Ç–∏—è, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –≤–∞—à–∏–º–∏ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–º–∏ —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏</li>
                                    <li>–û–±—Ä–∞—â–∞–π—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –º–æ–º–µ–Ω—Ç—ã, –∫–æ–≥–¥–∞ —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–±—è —Ö–æ—Ä–æ—à–æ</li>
                                    <li>–ó–∞–ø–∏—Å—ã–≤–∞–π—Ç–µ —É—Å–ø–µ—Ö–∏ –∏ –ø—Ä–∏—è—Ç–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card border-danger mb-3">
                            <div class="card-body">
                                <h6>–£–º–µ–Ω—å—à–∞–π—Ç–µ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã:</h6>
                                <ul class="mb-0">
                                    <li>–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ —Å–ø–æ—Å–æ–±—ã –∏–∑–±–µ–≥–∞–Ω–∏—è –∏–ª–∏ —Å–º—è–≥—á–µ–Ω–∏—è –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤</li>
                                    <li>–†–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ coping —Å –Ω–µ–ø—Ä–∏—è—Ç–Ω—ã–º–∏ —Å–∏—Ç—É–∞—Ü–∏—è–º–∏</li>
                                    <li>–û–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}